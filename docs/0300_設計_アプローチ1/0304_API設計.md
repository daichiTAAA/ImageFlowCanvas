# ImageFlowCanvas APIè¨­è¨ˆæ›¸

# æ–‡æ›¸ç®¡ç†æƒ…å ±

| é …ç›®       | å†…å®¹                      |
| ---------- | ------------------------- |
| æ–‡æ›¸å     | ImageFlowCanvas APIè¨­è¨ˆæ›¸ |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | 1.0                       |
| ä½œæˆæ—¥     | 2025å¹´7æœˆ12æ—¥             |
| æ›´æ–°æ—¥     | 2025å¹´7æœˆ12æ—¥             |


---

# 1. ãƒ—ãƒ­ãƒˆã‚³ãƒ«è¨­è¨ˆ

## 1.1. ãƒãƒƒãƒå‡¦ç†ï¼ˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œï¼‰ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant Client as ğŸ–¥ï¸ å¤–éƒ¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
    participant Gateway as ğŸšª API Gateway
    participant API as ğŸ”§ Backend API
    participant gRPCServices as âš¡ gRPCå¸¸é§ã‚µãƒ¼ãƒ“ã‚¹
    participant MinIO as ğŸ’¾ MinIO
    participant Kafka as ğŸ“¨ Kafka
    participant WebUI as ğŸŒ Web UI

    Note over Client, WebUI: 1. ãƒãƒƒãƒå‡¦ç†è¦æ±‚
    Client->>Gateway: REST API<br/>POST /executions<br/>multipart/form-data<br/>ï¼ˆç”»åƒãƒ•ã‚¡ã‚¤ãƒ« + pipeline_idï¼‰
    Gateway->>API: HTTP/1.1è»¢é€
    API->>MinIO: ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ (S3 API)
    MinIO-->>API: file_idè¿”å´
    API-->>Client: execution_idå³åº§ã«è¿”å´
    
    Note over Client, WebUI: 2. ç›´æ¥gRPCå®Ÿè¡Œï¼ˆ40-100msï¼‰
    API->>gRPCServices: ç›´æ¥gRPCå‘¼ã³å‡ºã—<br/>ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ<br/>ï¼ˆKafkaã‚’çµŒç”±ã—ãªã„ï¼‰
    gRPCServices->>MinIO: ç”»åƒå–å¾— (S3 API)
    gRPCServices->>gRPCServices: ç”»åƒå‡¦ç†å®Ÿè¡Œ<br/>ï¼ˆãƒªã‚µã‚¤ã‚ºâ†’AIæ¤œçŸ¥â†’ãƒ•ã‚£ãƒ«ã‚¿ï¼‰
    gRPCServices->>MinIO: çµæœä¿å­˜ (S3 API)
    gRPCServices-->>API: å‡¦ç†å®Œäº†é€šçŸ¥ (40-100ms)
    
    Note over Client, WebUI: 3. é€²æ—é€šçŸ¥ï¼ˆç›£è¦–ç”¨ï¼‰
    gRPCServices->>Kafka: é€²æ—é€šçŸ¥<br/>Topic: pipeline-progress<br/>{<br/>  "execution_id": "exec-123",<br/>  "status": "completed",<br/>  "step_id": "resize-step-1"<br/>}
    
    Note over Client, WebUI: 4. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ UIæ›´æ–°
    API->>WebUI: WebSocketé€ä¿¡<br/>{<br/>  "type": "execution_update",<br/>  "execution_id": "exec-123",<br/>  "status": "completed"<br/>}
    
    Note over Client, WebUI: 5. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ï¼ˆå¤±æ•—æ™‚ã®ã¿ï¼‰
    API-->>Kafka: Kafkaãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯<br/>ï¼ˆç›´æ¥gRPCå¤±æ•—æ™‚ã®ã¿ï¼‰<br/>Topic: image-processing-requests
```
    
## 1.2. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†ï¼ˆæ˜ åƒã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ï¼‰ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant CameraApp as ï¿½ ã‚«ãƒ¡ãƒ©ã‚¢ãƒ—ãƒª
    participant Gateway as ğŸšª API Gateway  
    participant StreamService as ğŸ¬ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹
    participant AIService as ğŸ¤– AIæ¤œçŸ¥ã‚µãƒ¼ãƒ“ã‚¹
    participant Kafka as ğŸ“¨ Kafka
    participant WebUI as ğŸŒ Web UI

    Note over CameraApp, WebUI: 1. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ˜ åƒã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
    CameraApp->>Gateway: gRPC Stream<br/>VideoFrame{<br/>  frame_data: bytes,<br/>  timestamp_ms: 1234567890,<br/>  metadata: {<br/>    source_id: "cam-001",<br/>    pipeline_id: "realtime-detect"<br/>  }<br/>}
    Gateway->>StreamService: gRPCã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°è»¢é€
    
    Note over CameraApp, WebUI: 2. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¨è«–ï¼ˆ<50msï¼‰
    StreamService->>AIService: gRPC Streamå‡¦ç†<br/>ï¼ˆãƒ¡ãƒ¢ãƒªãƒ™ãƒ¼ã‚¹ã€æ°¸ç¶šåŒ–ãªã—ï¼‰
    AIService->>AIService: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ AIæ¨è«–<br/>YOLO11ã«ã‚ˆã‚‹ç‰©ä½“æ¤œçŸ¥
    AIService-->>StreamService: ProcessedFrame{<br/>  processed_data: bytes,<br/>  detections: [...],<br/>  processing_time_ms: 35<br/>}
    
    Note over CameraApp, WebUI: 3. çµæœã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
    StreamService-->>Gateway: gRPC Streamè¿”å´
    Gateway-->>CameraApp: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµæœé…ä¿¡
    
    Note over CameraApp, WebUI: 4. é¸æŠçš„ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
    StreamService-->>Kafka: æ˜ åƒã‚¢ãƒ¼ã‚«ã‚¤ãƒ–<br/>Topic: video-stream-archive<br/>ï¼ˆé‡è¦ãƒ•ãƒ¬ãƒ¼ãƒ ã®ã¿ï¼‰
    
    Note over CameraApp, WebUI: 5. ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°
    StreamService-->>WebUI: WebSocketé€šçŸ¥<br/>{<br/>  "type": "stream_stats",<br/>  "fps": 30,<br/>  "latency_ms": 45<br/>}
```

## 1.3. ãƒ—ãƒ­ãƒˆã‚³ãƒ«æœ€é©åŒ–ã®é¸æŠåŸºæº–

| ğŸ¯ ç”¨é€”ãƒ»ã‚·ãƒŠãƒªã‚ª     | ğŸš€ æ¨å¥¨ãƒ—ãƒ­ãƒˆã‚³ãƒ«    | âš¡ æ€§èƒ½ç‰¹æ€§                                                           | ğŸ“ é¸æŠç†ç”±                               |
| :------------------- | :------------------ | :------------------------------------------------------------------- | :--------------------------------------- |
| ãƒãƒƒãƒç”»åƒå‡¦ç†       | REST API + ç›´æ¥gRPC | â€¢ è¶…é«˜é€Ÿå‡¦ç† (40-100ms)<br/>â€¢ ãƒ•ã‚¡ã‚¤ãƒ«æ°¸ç¶šåŒ–<br/>â€¢ é«˜ä¿¡é ¼æ€§          | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œã€çµæœä¿å­˜ãŒå¿…è¦ãªç”¨é€”   |
| ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ˜ åƒå‡¦ç† | gRPC Streaming      | â€¢ æ¥µä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· (<50ms)<br/>â€¢ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¯¾å¿œ<br/>â€¢ ãƒ¡ãƒ¢ãƒªãƒ™ãƒ¼ã‚¹ | ãƒ©ã‚¤ãƒ–é…ä¿¡ã€ç›£è¦–ã‚«ãƒ¡ãƒ©ã€æ¤œæŸ»ã‚·ã‚¹ãƒ†ãƒ ç”¨é€” |
| é€²æ—é€šçŸ¥ãƒ»ç›£è¦–       | Kafka + WebSocket   | â€¢ éåŒæœŸé€šçŸ¥<br/>â€¢ é«˜ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ<br/>â€¢ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§               | ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°         |
| ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†   | Kafka Consumer      | â€¢ é«˜ä¿¡é ¼æ€§<br/>â€¢ é †åºä¿è¨¼<br/>â€¢ è€éšœå®³æ€§                             | ç›´æ¥gRPCå¤±æ•—æ™‚ã®ä»£æ›¿å‡¦ç†                 |
| UIæ›´æ–°é€šçŸ¥           | WebSocket           | â€¢ åŒæ–¹å‘é€šä¿¡<br/>â€¢ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§<br/>â€¢ ä½ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰             | é€²æ—è¡¨ç¤ºã€ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰             |
| ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–         | S3 API              | â€¢ RESTful<br/>â€¢ æ¨™æº–äº’æ›<br/>â€¢ é«˜å¯ç”¨æ€§                              | MinIOã¨ã®é€£æºã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸    |
| ã‚µãƒ¼ãƒ“ã‚¹é–“å†…éƒ¨é€šä¿¡   | ç›´æ¥gRPC            | â€¢ å‹å®‰å…¨<br/>â€¢ è¶…é«˜æ€§èƒ½<br/>â€¢ Protocol Buffers                       | ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å†…éƒ¨ã®é«˜é€Ÿé€šä¿¡           |

## 1.4. å‡¦ç†æ–¹å¼åˆ¥ãƒ—ãƒ­ãƒˆã‚³ãƒ«ä»•æ§˜

### 1.4.1. ğŸ“‹ ãƒãƒƒãƒå‡¦ç†ï¼ˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œï¼‰ä»•æ§˜

REST API multipart/form-dataã§ã®ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¨ã€ç›´æ¥gRPCå®Ÿè¡Œã«ã‚ˆã‚‹40-100msé«˜é€Ÿå‡¦ç†ã‚’æä¾›ã€‚
å®Ÿè¡Œå®Œäº†å¾Œã€WebSocketã§é€²æ—é€šçŸ¥ã‚’é€ä¿¡ã—ã¾ã™ã€‚

### 1.4.2. ğŸ¬ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†ï¼ˆæ˜ åƒã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ï¼‰ä»•æ§˜

gRPCã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ˜ åƒå‡¦ç†ã€‚50msä»¥ä¸‹ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã§
AIæ¤œå‡ºçµæœã‚’å«ã‚€å‡¦ç†æ¸ˆã¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’è¿”å´ã—ã¾ã™ã€‚

### 1.4.3. ğŸ“¨ ç›£è¦–ãƒ»é€šçŸ¥ãƒ—ãƒ­ãƒˆã‚³ãƒ«ä»•æ§˜

Kafkaã«ã‚ˆã‚‹é€²æ—é€šçŸ¥ã¨WebSocketã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã§ã€
å®Ÿè¡ŒçŠ¶æ³ã®ç›£è¦–ã¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºã‚’è¡Œã„ã¾ã™ã€‚

# 2. API ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

## 2.1. ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰APIã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 2.1.1. Backend APIè¨­è¨ˆæ€æƒ³

ImageFlowCanvasã®Backend APIã¯ã€**FastAPI + grpcio**ã«ã‚ˆã‚‹ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å®Ÿè£…ã‚’æ¡ç”¨ã—ã€è¤‡æ•°ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’çµ±åˆç®¡ç†ã™ã‚‹ã€Œå¸ä»¤å¡”ã€ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚

```python
# ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒãƒ¼æ§‹æˆä¾‹
from fastapi import FastAPI
import grpc
from concurrent import futures
import asyncio

class HybridBackendAPI:
    def __init__(self):
        # FastAPI: REST + WebSocket
        self.fastapi_app = FastAPI()
        
        # gRPC Server: é«˜æ€§èƒ½å‡¦ç†
        self.grpc_server = grpc.server(futures.ThreadPoolExecutor())
        
        # å†…éƒ¨ã‚µãƒ¼ãƒ“ã‚¹æ¥ç¶šç®¡ç†
        self.grpc_clients = GRPCClientManager()
```

### 2.1.2. ãƒ—ãƒ­ãƒˆã‚³ãƒ«çµ±åˆæˆ¦ç•¥

| ãƒ—ãƒ­ãƒˆã‚³ãƒ« | æ‹…å½“é ˜åŸŸ | å®Ÿè£…æŠ€è¡“ | ç‰¹å¾´ |
|------------|----------|----------|------|
| **FastAPI** | REST API + WebSocket | uvicorn + asyncio | è‡ªå‹•ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆã€éåŒæœŸå‡¦ç† |
| **grpcio** | gRPCã‚µãƒ¼ãƒãƒ¼ | grpcio + asyncio | é«˜æ€§èƒ½ã€å‹å®‰å…¨æ€§ã€Protocol Buffers |
| **WebSocket** | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ | FastAPI WebSocket | åŒæ–¹å‘é€šä¿¡ã€ç–çµåˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ |
| **Kafka Consumer** | é€²æ—é…ä¿¡ | aiokafka | éåŒæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ« |

## 2.2. RESTful APIè¨­è¨ˆ

### 2.2.1. åŸºæœ¬ä»•æ§˜
- ãƒ™ãƒ¼ã‚¹URL: `https://api.imageflowcanvas.com/v1`
- ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼šHTTPSå¿…é ˆ
- èªè¨¼ï¼šBearer Token (JWT)
- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ï¼š`application/json`
- ã‚¨ãƒ©ãƒ¼ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼šRFC 7807æº–æ‹ 

### 2.2.2. å®Ÿè£…æ¸ˆã¿ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

| ã‚«ãƒ†ã‚´ãƒª       | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ            | ãƒ¡ã‚½ãƒƒãƒ‰ | ç”¨é€”                 | å®Ÿè£…çŠ¶æ³ |
| -------------- | ------------------------- | -------- | -------------------- | -------- |
| èªè¨¼           | `/auth/login`             | POST     | ãƒ­ã‚°ã‚¤ãƒ³             | âœ… |
| èªè¨¼           | `/auth/logout`            | POST     | ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ           | âœ… |
| ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ | `/health`                 | GET      | ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ç¢ºèª     | âœ… |
| ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³   | `/pipelines`              | GET      | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ä¸€è¦§     | âœ… |
| ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³   | `/pipelines`              | POST     | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ä½œæˆ     | âœ… |
| ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³   | `/pipelines/{id}`         | GET      | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è©³ç´°     | âœ… |
| ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³   | `/pipelines/{id}`         | PUT      | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ›´æ–°     | âœ… |
| ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³   | `/pipelines/{id}`         | DELETE   | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å‰Šé™¤     | âœ… |
| å®Ÿè¡Œ           | `/executions`             | POST     | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ     | âœ… |
| å®Ÿè¡Œ           | `/executions/{id}`        | GET      | å®Ÿè¡ŒçŠ¶æ³å–å¾—         | âœ… |
| å®Ÿè¡Œ           | `/executions/{id}/cancel` | POST     | å®Ÿè¡Œã‚­ãƒ£ãƒ³ã‚»ãƒ«       | âœ… |
| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | `/components`             | GET      | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¸€è¦§   | âœ… |
| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | `/components/{id}`        | GET      | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°   | âœ… |
| ãƒ•ã‚¡ã‚¤ãƒ«       | `/files`                  | POST     | ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ | âœ… |
| ãƒ•ã‚¡ã‚¤ãƒ«       | `/files/{id}`             | GET      | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ | âœ… |
| gRPCã‚µãƒ¼ãƒ“ã‚¹   | `/grpc-services`          | GET      | gRPCã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ³     | âœ… |
| ã‚«ãƒ¡ãƒ©ã‚¹ãƒˆãƒªãƒ¼ãƒ  | `/camera-stream`         | WebSocket | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ˜ åƒ     | âœ… |

### 2.2.3. WebSocketå°‚ç”¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- `/ws/execution/{execution_id}`: å®Ÿè¡Œé€²æ—é€šçŸ¥
- `/ws/system-status`: ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
- `/ws/camera-stream`: ã‚«ãƒ¡ãƒ©ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°

# 3. APIè©³ç´°ä»•æ§˜

## 3.1. ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡ŒAPIï¼ˆç›´æ¥gRPCå®Ÿè¡Œï¼‰

ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: `POST /v1/executions`

æ©Ÿèƒ½: ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å‡¦ç†ã‚’å®Ÿè¡Œ

ãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼: multipart/form-data
- pipeline_id (å¿…é ˆ): å®Ÿè¡Œã™ã‚‹ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®UUID
- input_files (å¿…é ˆ): å…¥åŠ›ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè¤‡æ•°å¯¾å¿œï¼‰
- parameters (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): å®Ÿè¡Œæ™‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆJSONå½¢å¼ï¼‰
- priority (ã‚ªãƒ—ã‚·ãƒ§ãƒ³): å„ªå…ˆåº¦ï¼ˆlow/normal/highï¼‰

ãƒ¬ã‚¹ãƒãƒ³ã‚¹:
- 202: å®Ÿè¡Œè¦æ±‚å—ä»˜ï¼ˆ40-100mså¾Œã«å®Œäº†äºˆå®šï¼‰
- 400: ç„¡åŠ¹ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- 500: ç›´æ¥gRPCå®Ÿè¡Œå¤±æ•—ï¼ˆKafkaãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰

## 3.2. å®Ÿè¡ŒçŠ¶æ³å–å¾—APIï¼ˆè¶…é«˜é€Ÿå®Œäº†å¯¾å¿œï¼‰

ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: `GET /v1/executions/{execution_id}`

æ©Ÿèƒ½: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œã®çŠ¶æ³ã‚’å–å¾—

ãƒ¬ã‚¹ãƒãƒ³ã‚¹æƒ…å ±:
- execution_id: å®Ÿè¡ŒID
- status: å®Ÿè¡ŒçŠ¶æ³ï¼ˆpending/running/completed/failed/cancelledï¼‰
- execution_mode: å®Ÿè¡Œæ–¹å¼ï¼ˆdirect_grpc/kafka_fallbackï¼‰
- processing_time_ms: å®Ÿéš›ã®å‡¦ç†æ™‚é–“
- progress: é€²æ—æƒ…å ±
- steps: å„ã‚¹ãƒ†ãƒƒãƒ—ã®è©³ç´°çŠ¶æ³
- output_files: å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±

# 4. gRPC APIè¨­è¨ˆ

## 4.1. å®Ÿè£…æ¸ˆã¿gRPCã‚µãƒ¼ãƒ“ã‚¹

### 4.1.1. ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆ

ImageFlowCanvasã§ã¯ã€ä»¥ä¸‹ã®gRPCã‚µãƒ¼ãƒ“ã‚¹ãŒå®Ÿè£…ãƒ»ç¨¼åƒã—ã¦ã„ã¾ã™ï¼š

| ã‚µãƒ¼ãƒ“ã‚¹å | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | æ©Ÿèƒ½ | Protocol Buffers |
|------------|----------------|------|------------------|
| **ResizeService** | `resize-grpc-app:50051` | ç”»åƒãƒªã‚µã‚¤ã‚ºå‡¦ç† | `resize.proto` |
| **AIDetectionService** | `ai-detection-grpc-app:50052` | AIç‰©ä½“æ¤œå‡ºãƒ»åˆ†é¡ | `ai_detection.proto` |
| **FilterService** | `filter-grpc-app:50053` | ç”»åƒãƒ•ã‚£ãƒ«ã‚¿å‡¦ç† | `filter.proto` |
| **CameraStreamService** | `camera-stream-grpc-app:50054` | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ˜ åƒå‡¦ç† | `camera_stream.proto` |

### 4.1.2. å…±é€šãƒ—ãƒ­ãƒˆã‚³ãƒ«å®šç¾©ï¼ˆcommon.protoï¼‰

```protobuf
syntax = "proto3";
package imageflow.v1;

// å…±é€šç”»åƒãƒ‡ãƒ¼ã‚¿æ§‹é€ 
message ImageData {
  string bucket = 1;
  string object_key = 2;
  string content_type = 3;
  int64 size_bytes = 4;
  int32 width = 5;
  int32 height = 6;
  google.protobuf.Timestamp created_at = 7;
}

// ç›´æ¥ç”»åƒãƒã‚¤ãƒˆï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†ç”¨ï¼‰
message ImageBytes {
  bytes data = 1;
  string format = 2;  // "JPEG", "PNG"
  int32 width = 3;
  int32 height = 4;
}

// å‡¦ç†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
enum ProcessingStatus {
  PROCESSING_STATUS_UNSPECIFIED = 0;
  PROCESSING_STATUS_PENDING = 1;
  PROCESSING_STATUS_RUNNING = 2;
  PROCESSING_STATUS_COMPLETED = 3;
  PROCESSING_STATUS_FAILED = 4;
}

// å‡¦ç†çµæœå…±é€šæ§‹é€ 
message ProcessingResult {
  ProcessingStatus status = 1;
  string message = 2;
  ImageData output_image = 3;
  bytes output_data = 7;  // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†ç”¨
  map<string, string> metadata = 4;
  google.protobuf.Timestamp processed_at = 5;
  double processing_time_seconds = 6;
}
```

## 4.2. å€‹åˆ¥ã‚µãƒ¼ãƒ“ã‚¹ä»•æ§˜

### 4.2.1. ResizeService (resize.proto)

**æ©Ÿèƒ½**: ç”»åƒãƒªã‚µã‚¤ã‚ºãƒ»å½¢å¼å¤‰æ›
**å‡¦ç†æ™‚é–“**: 10-20ms
**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: resize-grpc-app:50051

```protobuf
service ResizeService {
  rpc Resize(ResizeRequest) returns (ResizeResponse);
  rpc HealthCheck(HealthCheckRequest) returns (HealthCheckResponse);
}

message ResizeRequest {
  ImageData input_image = 1;
  int32 target_width = 2;
  int32 target_height = 3;
  string resize_mode = 4;  // "fit", "fill", "stretch"
  bool maintain_aspect_ratio = 5;
}

message ResizeResponse {
  ProcessingResult result = 1;
}
```

### 4.2.2. AIDetectionService (ai_detection.proto)

**æ©Ÿèƒ½**: AIç‰©ä½“æ¤œå‡ºãƒ»åˆ†é¡
**å‡¦ç†æ™‚é–“**: 20-50ms (GPUä½¿ç”¨æ™‚)
**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: ai-detection-grpc-app:50052

```protobuf
service AIDetectionService {
  rpc Detect(DetectionRequest) returns (DetectionResponse);
  rpc HealthCheck(HealthCheckRequest) returns (HealthCheckResponse);
}

message DetectionRequest {
  ImageData input_image = 1;
  string model_name = 2;      // "yolo11", "resnet50"
  float confidence_threshold = 3;
  repeated string target_classes = 4;
}

message DetectionResponse {
  ProcessingResult result = 1;
  repeated Detection detections = 2;
}

message Detection {
  string class_name = 1;
  float confidence = 2;
  BoundingBox bbox = 3;
}

message BoundingBox {
  float x = 1;
  float y = 2;
  float width = 3;
  float height = 4;
}
```

### 4.2.3. FilterService (filter.proto)

**æ©Ÿèƒ½**: ç”»åƒãƒ•ã‚£ãƒ«ã‚¿ãƒ»å‰å¾Œå‡¦ç†
**å‡¦ç†æ™‚é–“**: 5-15ms
**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: filter-grpc-app:50053

```protobuf
service FilterService {
  rpc ApplyFilter(FilterRequest) returns (FilterResponse);
  rpc HealthCheck(HealthCheckRequest) returns (HealthCheckResponse);
}

message FilterRequest {
  ImageData input_image = 1;
  string filter_type = 2;    // "blur", "sharpen", "edge"
  map<string, string> parameters = 3;
}

message FilterResponse {
  ProcessingResult result = 1;
}
```

### 4.2.4. CameraStreamService (camera_stream.proto)

**æ©Ÿèƒ½**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ˜ åƒã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†
**ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·**: <50ms
**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: camera-stream-grpc-app:50054

```protobuf
service CameraStreamService {
  rpc ProcessVideoStream(stream VideoFrame) returns (stream ProcessedFrame);
  rpc HealthCheck(HealthCheckRequest) returns (HealthCheckResponse);
}

message VideoFrame {
  bytes frame_data = 1;
  int64 timestamp_ms = 2;
  map<string, string> metadata = 3;
}

message ProcessedFrame {
  bytes processed_data = 1;
  repeated Detection detections = 2;
  int64 processing_time_ms = 3;
  map<string, string> processing_stats = 4;
}
```

## 4.3. ã‚µãƒ¼ãƒ“ã‚¹æ¥ç¶šç®¡ç†

### 4.3.1. æ¥ç¶šè¨­å®š
```python
# gRPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®šä¾‹
GRPC_SERVICES = {
    "resize": {
        "address": "resize-grpc-app:50051",
        "timeout": 30,
        "retry_count": 3
    },
    "ai_detection": {
        "address": "ai-detection-grpc-app:50052", 
        "timeout": 60,
        "retry_count": 2
    },
    "filter": {
        "address": "filter-grpc-app:50053",
        "timeout": 20, 
        "retry_count": 3
    },
    "camera_stream": {
        "address": "camera-stream-grpc-app:50054",
        "timeout": 10,
        "retry_count": 1
    }
}
```

### 4.3.2. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãƒ»å†—é•·æ€§
- **ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯é–“éš”**: 10ç§’
- **ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼**: å¤±æ•—é–¾å€¤5å›ã€å¾©æ—§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ30ç§’
- **Kafkaãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ç›´æ¥gRPCå¤±æ•—æ™‚ã®ä»£æ›¿å‡¦ç†
- **ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°**: ã‚µãƒ¼ãƒ“ã‚¹åˆ¥ã®è² è·åˆ†æ•£

# 5. WebSocket APIè¨­è¨ˆ

## 5.1. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—é€šçŸ¥

```javascript
// WebSocketæ¥ç¶šã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
ws://localhost:8080/ws/execution/{execution_id}

// é€²æ—é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å½¢å¼
{
  "type": "progress",
  "execution_id": "exec-uuid-123",
  "step": "ai_detection",
  "progress": 65.5,
  "status": "processing",
  "timestamp": "2025-07-21T10:30:01.085Z",
  "data": {
    "current_component": "AI Detection Service",
    "elapsed_time_ms": 1750,
    "estimated_remaining_ms": 850
  }
}

// å®Œäº†é€šçŸ¥
{
  "type": "completed",
  "execution_id": "exec-uuid-123",
  "total_time_ms": 87,
  "output_files": [
    {
      "file_id": "output-123",
      "filename": "result.jpg",
      "download_url": "/api/v1/files/output-123/download"
    }
  ]
}

// ã‚¨ãƒ©ãƒ¼é€šçŸ¥
{
  "type": "error",
  "execution_id": "exec-uuid-123",
  "error": {
    "code": "AI_SERVICE_UNAVAILABLE",
    "message": "AI Detection Service temporarily unavailable",
    "retry_after": 30
  }
}
```

# 6. æ¤œæŸ»æ©Ÿèƒ½APIè¨­è¨ˆ

## 6.1. Tauriæ¤œæŸ»ã‚¢ãƒ—ãƒªAPI

### 6.1.1. æ¤œæŸ»ãƒã‚¹ã‚¿ç®¡ç†API

**æ¤œæŸ»å¯¾è±¡ãƒã‚¹ã‚¿**
```http
GET /api/v1/inspection/targets
POST /api/v1/inspection/targets
GET /api/v1/inspection/targets/{target_id}
PUT /api/v1/inspection/targets/{target_id}
DELETE /api/v1/inspection/targets/{target_id}
```

**æ¤œæŸ»é …ç›®ãƒã‚¹ã‚¿**
```http
GET /api/v1/inspection/targets/{target_id}/items
POST /api/v1/inspection/targets/{target_id}/items
GET /api/v1/inspection/items/{item_id}
PUT /api/v1/inspection/items/{item_id}
DELETE /api/v1/inspection/items/{item_id}
```

### 6.1.2. æ¤œæŸ»å®Ÿè¡ŒAPI

**æ¤œæŸ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**
```http
POST /api/v1/inspection/sessions
GET /api/v1/inspection/sessions/{session_id}
PUT /api/v1/inspection/sessions/{session_id}
POST /api/v1/inspection/sessions/{session_id}/complete
```

**AIæ¤œæŸ»å®Ÿè¡Œï¼ˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³é€£æºï¼‰**
```http
POST /api/v1/inspection/sessions/{session_id}/ai-inspection
```

ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹:
```json
{
  "session_id": "session-12345",
  "item_id": "item-67890",
  "image_file_path": "/path/to/captured/image.jpg",
  "pipeline_id": "pipeline-ai-detect-v1.2",
  "parameters": {
    "confidence_threshold": 0.8,
    "model_name": "yolo11"
  }
}
```

ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹:
```json
{
  "ai_result": {
    "overall_result": "NG",
    "confidence": 0.92,
    "detections": [
      {
        "class_name": "defect",
        "confidence": 0.92,
        "bbox": {"x": 150, "y": 200, "width": 50, "height": 30}
      }
    ]
  },
  "processing_time_ms": 1250,
  "pipeline_version": "v1.2",
  "created_at": "2025-07-27T10:30:00Z"
}
```

**äººã«ã‚ˆã‚‹æ¤œè¨¼API**
```http
POST /api/v1/inspection/sessions/{session_id}/human-verification
```

### 6.1.3. æ¤œæŸ»ãƒ‡ãƒ¼ã‚¿åŒæœŸAPI

**ã‚ªãƒ•ãƒ©ã‚¤ãƒ³åŒæœŸ**
```http
POST /api/v1/inspection/sync/upload
GET /api/v1/inspection/sync/download
```

**å·®åˆ†åŒæœŸ**
```http
GET /api/v1/inspection/sync/changes?since={timestamp}
POST /api/v1/inspection/sync/apply-changes
```

## 6.2. çµ±è¨ˆãƒ»ãƒ¬ãƒãƒ¼ãƒˆAPI

### 6.2.1. æ¤œæŸ»çµ±è¨ˆAPI

**åŸºæœ¬çµ±è¨ˆæƒ…å ±**
```http
GET /api/v1/inspection/statistics?start_date={date}&end_date={date}
```

ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹:
```json
{
  "summary": {
    "total_inspections": 1250,
    "ok_count": 1180,
    "ng_count": 70,
    "ok_rate": 94.4
  },
  "daily_trends": [
    {
      "date": "2025-07-27",
      "total": 85,
      "ok": 80,
      "ng": 5
    }
  ],
  "defect_analysis": {
    "scratch": 35,
    "contamination": 20,
    "deformation": 15
  }
}
```

### 6.2.2. å“è³ªãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”¨API

**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å“è³ªæŒ‡æ¨™**
```http
GET /api/v1/inspection/quality/realtime
WebSocket: /ws/quality-metrics
```

**æ¤œæŸ»å‚¾å‘åˆ†æ**
```http
GET /api/v1/inspection/quality/trends
GET /api/v1/inspection/quality/alerts
```

## 6.3. ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµ±åˆAPI

### 6.3.1. æ¤œæŸ»ç”¨ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ç®¡ç†

**æ¤œæŸ»é …ç›®ã¨ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®é–¢é€£ä»˜ã‘**
```http
GET /api/v1/inspection/items/{item_id}/pipeline
PUT /api/v1/inspection/items/{item_id}/pipeline
```

**ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œçµæœã®æ¤œæŸ»çµæœã¸ã®å¤‰æ›**
```http
POST /api/v1/inspection/pipeline-results/convert
```

### 6.3.2. Tauriã‚¢ãƒ—ãƒªå°‚ç”¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

**ãƒ‡ãƒã‚¤ã‚¹ç™»éŒ²ãƒ»èªè¨¼**
```http
POST /api/v1/tauri/devices/register
POST /api/v1/tauri/auth/login
```

**ã‚¢ãƒ—ãƒªè¨­å®šåŒæœŸ**
```http
GET /api/v1/tauri/config
PUT /api/v1/tauri/config
```

## 6.4. WebSocket APIè¨­è¨ˆ

### 6.4.1. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—é€šçŸ¥

WebSocketæ¥ç¶šã«ã‚ˆã‚Šã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œã®é€²æ—ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é€šçŸ¥ã—ã¾ã™ã€‚

**æ¥ç¶šã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**
```
ws://localhost:8080/ws/execution/{execution_id}
ws://localhost:8080/ws/system-status
ws://localhost:8080/ws/camera-stream
ws://localhost:8080/ws/quality-metrics
```

**é€²æ—é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å½¢å¼**
```javascript
// ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œé€²æ—
{
  "type": "progress",
  "execution_id": "exec-uuid-123",
  "step": "ai_detection",
  "progress": 65.5,
  "status": "processing",
  "timestamp": "2025-07-27T10:30:01.085Z",
  "data": {
    "current_component": "AI Detection Service",
    "elapsed_time_ms": 1750,
    "estimated_remaining_ms": 850
  }
}

// å®Œäº†é€šçŸ¥
{
  "type": "completed",
  "execution_id": "exec-uuid-123",
  "total_time_ms": 87,
  "output_files": [
    {
      "file_id": "output-123",
      "filename": "result.jpg",
      "download_url": "/api/v1/files/output-123/download"
    }
  ]
}

// ã‚¨ãƒ©ãƒ¼é€šçŸ¥
{
  "type": "error",
  "execution_id": "exec-uuid-123",
  "error": {
    "code": "AI_SERVICE_UNAVAILABLE",
    "message": "AI Detection Service temporarily unavailable",
    "retry_after": 30
  }
}
```

### 6.4.2. æ¤œæŸ»å“è³ªãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥

```javascript
// å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹æ›´æ–°
{
  "type": "quality_update",
  "timestamp": "2025-07-27T10:30:00Z",
  "metrics": {
    "hourly_ok_rate": 95.2,
    "current_ng_count": 3,
    "active_inspectors": 12
  }
}

// å“è³ªã‚¢ãƒ©ãƒ¼ãƒˆ
{
  "type": "quality_alert",
  "severity": "high",
  "message": "NG rate exceeded threshold (>5%)",
  "data": {
    "current_ng_rate": 7.2,
    "threshold": 5.0,
    "time_window": "last_hour"
  }
}
```

### 6.4.3. ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°æ˜ åƒé…ä¿¡

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ˜ åƒå‡¦ç†ã®çµæœã‚’WebSocketã§é…ä¿¡ã—ã¾ã™ã€‚
- æ˜ åƒãƒ•ãƒ¬ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®é…ä¿¡
- AIæ¤œå‡ºçµæœã®é€ä¿¡
- å‡¦ç†çµ±è¨ˆæƒ…å ±ã®é€šçŸ¥
- ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°åˆ¶å¾¡æ©Ÿèƒ½

## 6.5. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä»•æ§˜

### 6.5.1. æ¨™æº–ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆRFC 7807æº–æ‹ ï¼‰

```json
{
  "type": "https://api.imageflowcanvas.com/errors/validation-error",
  "title": "å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ãŒç„¡åŠ¹ã§ã™",
  "status": 400,
  "detail": "confidence_thresholdã¯0.0-1.0ã®ç¯„å›²ã§æŒ‡å®šã—ã¦ãã ã•ã„",
  "instance": "/api/v1/inspection/sessions/session-123/ai-inspection",
  "validation_errors": [
    {
      "field": "confidence_threshold",
      "message": "å€¤ã¯0.0ä»¥ä¸Š1.0ä»¥ä¸‹ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™",
      "value": 1.5
    }
  ]
}
```

### 6.5.2. æ¤œæŸ»æ©Ÿèƒ½ç‰¹æœ‰ã®ã‚¨ãƒ©ãƒ¼

```json
{
  "type": "https://api.imageflowcanvas.com/errors/inspection-error",
  "title": "æ¤œæŸ»å®Ÿè¡Œã‚¨ãƒ©ãƒ¼",
  "status": 422,
  "detail": "æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒæ¤œæŸ»é …ç›®ã¨äº’æ›æ€§ãŒã‚ã‚Šã¾ã›ã‚“",
  "inspection_context": {
    "session_id": "session-123",
    "item_id": "item-456",
    "pipeline_id": "pipeline-789"
  }
}
```